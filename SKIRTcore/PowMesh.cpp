/*//////////////////////////////////////////////////////////////////
////       SKIRT -- an advanced radiative transfer code         ////
////       Â© Astronomical Observatory, Ghent University         ////
///////////////////////////////////////////////////////////////// */

#include "FatalError.hpp"
#include "PowMesh.hpp"
#include "NR.hpp"

using namespace std;

////////////////////////////////////////////////////////////////////

PowMesh::PowMesh()
    : _ratio(0)
{
}

////////////////////////////////////////////////////////////////////

void PowMesh::setupSelfBefore()
{
    MoveableMesh::setupSelfBefore();
    if (_ratio<=0) throw FATALERROR("the bin width ratio should be positive");
}

////////////////////////////////////////////////////////////////////

void PowMesh::setRatio(double value)
{
    _ratio = value;
}

////////////////////////////////////////////////////////////////////

double PowMesh::ratio() const
{
    return _ratio;
}

////////////////////////////////////////////////////////////////////

Array PowMesh::mesh() const
{
    Array tv;
    if (numBins()>1) NR::powgrid(tv, 0.0, 1.0, numBins(), _ratio);
    else NR::lingrid(tv, 0.0, 1.0, 1);
    return tv;
}

//////////////////////////////////////////////////////////////////////
